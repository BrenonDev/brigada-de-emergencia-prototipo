<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Central de Emerg√™ncia Institucional</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
:root{
  --vermelho: #b00020;
  --vermelho-claro: #e53935;
  --cinza-escuro: #1f1f1f;
  --cinza: #2b2b2b;
  --branco: #ffffff;
}

*{
  box-sizing: border-box;
  font-family: Arial, Helvetica, sans-serif;
}

body{
  margin: 0;
  min-height: 100dvh;
  background: linear-gradient(180deg, #1a1a1a, #000000);
  display: flex;
  justify-content: center;
  align-items: center;
}

.container{
  width: 90%;
  max-width: 420px;
  background: var(--cinza);
  border-radius: 14px;
  padding: 25px 20px 30px;
  text-align: center;
  box-shadow: 0 0 25px rgba(255,0,0,0.2);
  border: 2px solid var(--vermelho);
}

.logo{
  font-size: 40px;
  margin-bottom: 5px;
}

h1{
  color: var(--branco);
  font-size: 1.6em;
  margin-bottom: 8px;
}

p{
  color: #cccccc;
  font-size: 0.95em;
  margin-bottom: 25px;
}

.btn{
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 10px;
  width: 100%;
  padding: 16px;
  margin: 10px 0;
  border-radius: 10px;
  text-decoration: none;
  font-size: 1em;
  font-weight: bold;
  color: var(--branco);
  background: linear-gradient(135deg, var(--vermelho), var(--vermelho-claro));
  transition: transform 0.2s, box-shadow 0.2s, opacity 0.2s;
  box-shadow: 0 4px 10px rgba(0,0,0,0.5);
}

.btn:hover{
  transform: scale(1.03);
  box-shadow: 0 6px 15px rgba(255,0,0,0.6);
  opacity: 0.95;
}

.footer{
  margin-top: 20px;
  font-size: 0.75em;
  color: #aaaaaa;
}
</style>
</head>

<body>

<div class="container">
  <div class="logo">üö®</div>
  <h1>Bot√µes de Emerg√™ncia</h1>
  <p>Toque no bot√£o correspondente para acionar o servi√ßo desejado imediatamente.</p>

  <!-- 1 -->
  <a class="btn" href="tel:+5511999990001">
    üìû Seguran√ßa Interna
  </a>

  <!-- 2 -->
  <a class="btn" href="tel:+5511999990002">
    üè• Enfermaria / Primeiros Socorros
  </a>

  <!-- 3 -->
  <a class="btn" onclick="enviarAlertaParaTodos()">
    üöí Corpo de Bombeiros
  </a>

  <!-- 4 -->
  <a class="btn" href="tel:190">
    üöì Pol√≠cia Militar (190)
  </a>

  <!-- 5 -->
  <a class="btn" href="tel:+5511999990002">
    ‚ö° Manuten√ß√£o Predial de Emerg√™ncia
  </a>

  <div class="footer">
    Sistema de resposta r√°pida institucional
  </div>
</div>
<script>
const contatos = [
  "5515996287208",
  "5515988221498"
];

let tentativa = 0;
const maxTentativas = 10;
let precisaoAceitavel = 5; // come√ßa exigente (30m)

function enviarAlertaParaTodos() {
  tentativa = 0;
  precisaoAceitavel = 5;
  obterLocalizacaoPrecisa();
}

function obterLocalizacaoPrecisa() {
  if (!navigator.geolocation) {
    alert("Geolocaliza√ß√£o n√£o suportada.");
    return;
  }

  tentativa++;

  navigator.geolocation.getCurrentPosition(
    pos => {
      const lat = pos.coords.latitude;
      const lon = pos.coords.longitude;
      const accuracy = pos.coords.accuracy;

      console.log("Tentativa:", tentativa, "Precis√£o:", accuracy);

      if (accuracy <= precisaoAceitavel || tentativa >= maxTentativas) {
        dispararWhatsApp(lat, lon, accuracy);
      } else {
        precisaoAceitavel += 5; // vai aceitando √°rea maior
        setTimeout(obterLocalizacaoPrecisa, 3000);
      }
    },
    err => {
      console.log("Erro localiza√ß√£o:", err);
      if (tentativa < maxTentativas) {
        setTimeout(obterLocalizacaoPrecisa, 3000);
      } else {
        alert("N√£o foi poss√≠vel obter localiza√ß√£o precisa.");
      }
    },
    {
      enableHighAccuracy: true,
      timeout: 10000,
      maximumAge: 0
    }
  );
}

function dispararWhatsApp(lat, lon, accuracy) {
  const linkMapa = `https://maps.google.com/?q=${lat},${lon}`;

  const mensagem = 
`üö® PEDIDO DE AJUDA üö®
Preciso de ajuda agora!
Minha localiza√ß√£o:
${linkMapa}
Precis√£o aproximada: ${Math.round(accuracy)} metros.`;

  abrirChatsSequencialmente(mensagem);
}

function abrirChatsSequencialmente(mensagem) {
  let i = 0;

  function abrirProximo() {
    if (i >= contatos.length) return;

    const url = `https://wa.me/${contatos[i]}?text=${encodeURIComponent(mensagem)}`;
    window.open(url, "_blank");

    i++;
    setTimeout(abrirProximo, 5000); // intervalo entre contatos
  }

  abrirProximo();
}
</script>
</body>
</html>
